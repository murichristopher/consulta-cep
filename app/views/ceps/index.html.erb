<div class="min-h-screen bg-base-200 flex items-center justify-center p-4" data-controller="cep">
  <div class="card w-full max-w-md bg-base-100 shadow-xl">
    <div class="card-body">
      <h2 class="card-title justify-center text-2xl mb-4">
        <%= t('ceps.index.search_title') %>
      </h2>

      <!-- Turbo Frame -->
      <turbo-frame id="cep_result">
        <%= form_with url: ceps_path, method: :get, data: { turbo_frame: "cep_result", action: "turbo:submit-start->cep#showLoading" } do |f| %>
          <div class="form-control">
            <label class="label">
              <span class="label-text"><%= t('ceps.index.enter_cep') %></span>
            </label>
            <%= f.text_field :cep,
                  class: "input input-bordered",
                  placeholder: t('ceps.index.placeholder'),
                  data: { cep_target: "input", action: "input->cep#format" },
                  pattern: "\\d{5}-?\\d{3}",
                  maxlength: 9 %>
          </div>
          <div class="form-control mt-6">
            <%= f.submit t('ceps.index.search_button'), class: "btn btn-primary" %>
          </div>
        <% end %>

        <div data-cep-target="skeleton" class="hidden mt-6 space-y-4">
          <div class="skeleton h-6 w-32 mx-auto"></div>
          <div class="skeleton h-4 w-48 mx-auto"></div>
          <div class="skeleton h-4 w-40 mx-auto"></div>
          <div class="skeleton h-4 w-36 mx-auto"></div>
          <div class="skeleton h-4 w-28 mx-auto"></div>
        </div>

        <% if @address.present? %>
          <div class="text-center space-y-2 my-4" data-cep-target="result">
            <p class="text-xl font-bold"><%= @address[:cep] %></p>
            <p class="text-lg"><strong><%= t('ceps.index.address') %>:</strong> <%= @address[:street] %></p>
            <p class="text-lg"><strong><%= t('ceps.index.district') %>:</strong> <%= @address[:district] %></p>
            <p class="text-lg"><strong><%= t('ceps.index.city') %>:</strong> <%= @address[:city] %></p>
            <p class="text-lg"><strong><%= t('ceps.index.state') %>:</strong> <%= @address[:state] %></p>
            <p class="text-lg"><strong><%= t('ceps.index.ddd') %>:</strong> <%= @address[:ddd] %></p>
          </div>
        <% elsif @error %>
          <div class="alert alert-error shadow-lg mt-4" data-cep-target="result">
            <div class="flex items-center">
              <%= heroicon "exclamation-triangle", options: { class: "h-8 w-6" } %>
              <span class="ml-2"><%= @error %></span>
            </div>
          </div>
        <% end %>
      </turbo-frame>
    </div>
  </div>
</div>